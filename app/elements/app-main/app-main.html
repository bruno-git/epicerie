<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="..\..\bower_components/polymer/polymer.html">

<dom-module id="app-main">
  <template>
    <style>
      :host {
        display: block;
      }
      .nav-top{
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        height: 50px;
        background: #1d232b;
        color: #fff;
        padding: 5px 5px;
        @apply(--layout-horizontal);
        @apply(--layout-justified);
        @apply(--layout-center);
      }
      .user-image2 {
        width:40px;
        height:40px;
        border-radius: 100%;
        transition: transform 300ms ease-in-out;
      }
      .lamain {
        cursor: pointer;
      }
      .test{
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }
      .nav-block {
        @apply(--layout-horizontal);
        @apply(--layout-center);
      }
      .nav-block > * {
        padding-left: 10px;
      }
    </style>
<!-- presentement non utilise...
    <data-usager userauth="[[userauth]]" userdata="{{userdata}}"></data-usager>
-->

    <data-commande-items userauth="[[userauth]]"
                         commande-selected="[[commandeSelected]]"
                         filter-zone="[[filterZone]]"
                         commandeitems="{{commandeitems}}">
    </data-commande-items>

    <paper-material elevation="1" class="nav-top">
      <div class="nav-block">
        <div>
          <iron-image src="../../images/epicier.png"
                      sizing="contain"
                      width="40"
                      height="40">
          </iron-image>
        </div>
        <span>Mon epicier</span>
      </div>
      <div class="lamain nav-block">
        <div>
          <iron-image id="userPicture"
                    src="{{userauth.google.cachedUserProfile.picture}}"
                    class="user-image2"
                    sizing="contain"
                    preload>
          </iron-image>
        </div>
        <span>[[userauth.google.displayName]]</span>
        <iron-icon icon="icons:arrow-drop-down"></iron-icon>
      </div>
    </paper-material>


        <!-- div pour compenser l'espace du header -->

        <div style="height: 50px"></div>


        <neon-animated-pages selected="[[pageSelected]]"
                             entry-animation="fade-in-animation"
                             exit-animation="fade-out-animation">
          <page-commandes userauth="[[userauth]]"
                          on-ouvre-commande="ouvreCommande"></page-commandes>
          <page-ma-commande commandeitems="{{commandeitems}}"
                            commande-selected="[[commandeSelected]]"
                            on-change-page="changePage"></page-ma-commande>
          <page-congelateur commandeitems="{{commandeitems}}"
                            on-change-page="changePage"></page-congelateur>
          <page-commande-items></page-commande-items>
        </neon-animated-pages>

    </paper-header-panel>

  </template>
  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'app-main',

      properties: {
        userauth: {
          type: Object
        },
        userdata: {
          type: Object
        },
        pageSelected: {
          type: Number,
          value: 0
        },
        commandeSelected: {
          type: String,
          value: null
        },
        filterZone: {
          type: String,
          value: 'null'
        }
      },
      //ouvreCommande recoit un objet commande depuis firebase (users>uid>commandes>fbkey)
      ouvreCommande: function(e) {
        console.log('APP-MAIN OUVRE COMMANDE: ' + e.detail.commande.cle);
        //console.log(e.detail);
        this.commandeSelected = e.detail.commande.cle;
        this.pageSelected = 1;
      },
      changePage: function(e) {
        console.log(e);
        if (e.detail.page == 'menu') {
          this.pageSelected = 0;
        }
        if (e.detail.page == 'ma-commande') {
          this.pageSelected = 1;
        }
        if (e.detail.page == 'congelateur') {
          console.log('APP-MAIN CHANGE PAGE: CONGELATEUR');

          this.filterZone = 'congelateur';
          this.pageSelected = 2;

          console.log('filterZone: ' + this.filterZone);
        }
      }
    });
  })();
  </script>
</dom-module>
